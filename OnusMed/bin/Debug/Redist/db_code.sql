commit;
drop schema if exists med_test;
create schema med_test;
create table med_test.patient(id varchar(100) not null primary key,name varchar(200) not null, address1 varchar(200) not null, address2 varchar(200), city varchar(50) not null, state varchar(50) not null, pin int not null, contact varchar(20) not null, email varchar(200), credit float(2) default 0);
insert into med_test.patient values('N/A','CASH','N/A','N/A','N/A','N/A',0,0,'',0);
create table med_test.supplier(id varchar(100) not null primary key, name varchar(200) not null, address1 varchar(200) not null, address2 varchar(200), city varchar(50) not null, state varchar(50) not null, pin int not null, contact long not null, email varchar(200), dlbio varchar(100) not null, dlnbio varchar(100) not null, gstin varchar(50) not null, credit float(2) default 0);
create table med_test.salesman(id varchar(100) not null primary key, pwd varchar(500) not null, name varchar(200) not null, address1 varchar(200) not null, address2 varchar(200), city varchar(50) not null, state varchar(50) not null, pin int not null, post varchar(50) not null, contact varchar(20) not null, email varchar(200), comm float(2) default 0);
create table med_test.pdoctor(reg varchar(100) not null primary key, name varchar(200) not null, spec varchar(200), hospital varchar(200));
insert into med_test.pdoctor values('0','N/A','','');
create table med_test.odoctor(reg varchar(100) not null primary key, name varchar(200) not null, address1 varchar(200) not null, address2 varchar(200), city varchar(50) not null, state varchar(50) not null, pin int not null, contact varchar(20) not null, email varchar(200), charges float(2) default 0, comm float(2) default 0, days varchar(500) not null);
create table med_test.medtypes(type varchar(30) not null primary key);
insert into med_test.medtypes values('Syrup'),('Tablet'),('Capsule'),('Injection'),('Cylinder'),('Suppository');
create table med_test.schedule(sched varchar(30) not null primary key);
insert into med_test.schedule values('OTC');
create table med_test.medicine(code varchar(50) not null primary key, name varchar(500) not null, manufacturer varchar(500) not null, type varchar(30) not null references med_test.medtypes, sched varchar(30) not null, minstock int default 0, packc int default 1, stripc int default 1, comp1 varchar(200) not null, comp2 varchar(200),hsn varchar(200),gst float(2));
create table med_test.storetypes(type varbinary(30) not null primary key);
insert into med_test.storetypes values('STO'),('GD');
create table med_test.store(name varchar(200) not null, type varchar(30) not null references med_test.storetypes, address1 varchar(200) not null, address2 varchar(200), city varchar(100) not null, state varchar(100) not null, statec varchar(50) not null, pin int not null, contact varchar(20) not null);
insert into med_test.store values('Test Store Pvt. Ltd.','STO','TestAddress01','TestAddress02','TestCity0','TestState0','010',777777,'7777777777');
create table med_test.expenses(edate date not null, stationary float(2) default 0, repairs float(2) default 0, petty float(2) default 0, salary float(2) default 0, wages float(2) default 0);
create table med_test.instrutypes(type varchar(5) not null);
insert into med_test.instrutypes values('CHQ'),('DD'),('N/A');
create table med_test.cardtypes(type varchar(50) not null primary key);
insert into med_test.cardtypes values('N/A'),('VISA Debit'),('VISA Credit'),('MasterCard Debit'),('MasterCard Credit'),('Rupay Debit'),('Rupay Credit'),('Maestro'),('AmEx Debit'),('AmEx Credit'),('Discover Debit'),('Discover Credit');
create table med_test.gstin(statec varchar(20) not null, gstin varchar(30) not null);
insert into med_test.gstin values('010','123456789');
create table med_test.inventory(batchcode varchar(100) not null, code varchar(50) not null references med_test.medicine(code), expiry date not null, mrp_pack float(2) default 0, mrp_strip float(2) default 0, mrp_piece float(2) default 0, pur_rate_pack float(2) default 0, pur_rate_strip float(2) default 0, pur_rate_piece float(2) default 0, trade_rate_pack float(2) default 0, trade_rate_strip float(2) default 0, trade_rate_piece float(2) default 0, cgst float(2) default 0, sgst float(2) default 0,  igst float(2) default 0, stock_pack float(2) default 0, stock_strip float(2) default 0, stock_piece int default 0, location varchar(200) not null, allow_neg boolean not null,  ed float(2) default 0);
create table med_test.gst_info(statec varchar(20) not null, state varchar(200) not null, cgst float(2) default 0, sgst float(2) default 0, igst float(2) default 0);
create table med_test.opd(app_id varchar(100) not null primary key, doc_id varchar(100) not null references med_test.odoctor(reg), pat_id varchar(100) not null references med_test.patient(id), contact varchar(50) not null, age int default 0, problem varchar(10000), vdate date not null, vtime varchar(100) not null, stat varchar(100));
create table med_test.sales(invoice_no varchar(100) not null, icode varchar(50) not null references med_test.medicine(code), batchcode varchar(100) not null references med_test.inventory(batchcode), idate date not null, pid varchar(100) not null references med_test.patient(id), pname varchar(200) not null, pdoctor_reg varchar(100) references med_test.pdoctor(reg), pdoctor_name varchar(200), pack_q float(2) default 0, stripq float(2) default 0, pieceq int default 0, pack_mrp float(2) default 0, strip_mrp float(2) default 0, piece_mrp float(2) default 0, discount float(2) default 0, cgst float(2) default 0, sgst float(2) default 0, igst float(2) default 0, ed float(2) default 0, amt float(2) default 0,salesman varchar(200));
create table med_test.purchase(invoice_no varchar(100) not null, icode varchar(50) not null references med_tes.medicine(code), batchcode varchar(100) not null, suppl varchar(100) not null references med_test.supplier(id), idate date not null, edate date not null, pack_q float(2) default 0, strip_q float(2) default 0, piece_q int default 0, free_pack float(2) default 0, free_strip float(2) default 0, free_piece int default 0, mrp_pack float(2) default 0, mrp_strip float(2) default 0, mrp_piece float(2) default 0, pr_pack float(2) default 0, pr_strip float(2) default 0, pr_piece float(2) default 0, discount float(2) default 0, cgst float(2) default 0, sgst float(2) default 0, igst float(2) default 0, ed float(2) default 0, amt float(2) default 0);
create table med_test.p_payments(invoice_no varchar(100) not null, pdate date not null, cash float(2) default 0, card float(2) default 0, card_type varchar(50) not null default 'N/A' references med_test.cardtypes(type), bank float(2) not null default 0, instru varchar(100) not null default 'N/A' references med_test.instrutypes(type), instru_id varchar(200) not null default 'N/A', credit float(2) default 0);
create table med_test.s_payments(invoice_no varchar(100) not null, pdate date not null, cash float(2) default 0, card float(2) default 0, card_type varchar(50) not null default 'N/A' references med_test.cardtypes(type), wallet float(2) default 0, w_tr_ref varchar(200) not null default 'N/A', bank float(2) not null default 0, instru varchar(100) not null default 'N/A' references med_test.instrutypes(type), instru_id varchar(200) not null default 'N/A', credit float(2) default 0);
create table med_test.sales_r(invoice_no varchar(100) not null, icode varchar(50) not null references med_test.medicine(code), batchcode varchar(100) not null, idate date not null, pid varchar(100) not null references med_test.patient(id), pname varchar(200) not null, pdoctor_reg varchar(100) references med_test.pdoctor(reg), pdoctor_name varchar(200), pack_q float(2) default 0, stripq float(2) default 0, pieceq int default 0, pack_mrp float(2) default 0, strip_mrp float(2) default 0, piece_mrp float(2) default 0, discount float(2) default 0, cgst float(2) default 0, sgst float(2) default 0, igst float(2) default 0, ed float(2) default 0);
create table med_test.purchase_r(invoice_no varchar(100) not null, icode varchar(50) not null references med_tes.medicine(code), batchcode varchar(100) not null references med_test.inventory(batchcode), suppl varchar(100) not null references med_test.supplier(id), idate date not null, pack_q float(2) default 0, strip_q float(2) default 0, piece_q int default 0, free_pack float(2) default 0, free_strip float(2) default 0, free_piece int default 0, pr_pack float(2) default 0, pr_strip float(2) default 0, pr_piece float(2) default 0, discount float(2) default 0, cgst float(2) default 0, sgst float(2) default 0, igst float(2) default 0, ed float(2) default 0);
create table med_test.pr_payments(invoice_no varchar(100) not null,pdate date not null,cash float(2) default 0,bank float(2) default 0,instrutype varchar(5) not null default 'N/A' references med_test.intrutypes(type),instru_id varchar(100) not null default 'N/A', card float(2) default 0, card_type varchar(50) not null default 'N/A' references med_test.cardtypes(type),credit float(2) default 0);
create table med_test.sr_payments(invoice_no varchar(100) not null,pdate date not null,cash float(2) default 0,bank float(2) default 0,instrutype varchar(5) not null default 'N/A' references med_test.intrutypes(type),instru_id varchar(100) not null default 'N/A', credit float(2) default 0);
create table med_test.pcr_payments(pdate date not null,cash float(2),bank float(2), instru varchar(5),instruno varchar(100),card float(2),card_type varchar(100),wallet float(2),wallet_rem varchar(500));
create table med_test.scr_payments(pdate date not null,cash float(2),bank float(2), instru varchar(5),instruno varchar(100),card float(2),card_type varchar(100));
insert into med_test.salesman values('E20180811043101', '85837f917f90b0bec481c7340458b16b7ed35a7dcb32312deb891202ce9b6050400753e8fdb8a1b08c80574cbbff163e', 'IT Admin', 'TestAddr01', 'TestAddr02', 'TestCity2', 'TestState2', '777777', 'IT', '7777777777', 'itadmin@onus.com', '0');
create table med_test.logs(ldate date,ltime time,lquery varchar(5000));
commit;